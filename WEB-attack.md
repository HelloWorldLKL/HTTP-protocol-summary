# WEB 攻击技术

## 因输出转义不完全导致

### 跨站脚本攻击

#### 概述

跨站脚本（英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程序的安全漏洞攻击，是代码注入的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。**XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。**这些恶意网页程序通常是JavaScript，但实际上也可以包括Java，VBScript，ActiveX，Flash或者甚至是普通的HTML。攻击成功后，攻击者可能得到更高的权限（如执行一些操作）、私密网页内容、会话和cookie等各种内容。

#### 攻击手段和目的

攻击者使被攻击者在浏览器中执行脚本后，如果需要收集来自被攻击者的数据（如cookie或其他敏感信息），可以自行架设一个网站，让被攻击者通过JavaScript等方式把收集好的数据作为参数提交，随后以数据库等形式记录在攻击者自己的服务器上。常用的XSS攻击手段和目的有：

- 盗用cookie，获取敏感信息。
- 利用植入Flash，通过crossdomain权限设置进一步获取更高权限；或者利用Java等得到类似的操作。。
- 利用iframe、frame、XMLHttpRequest或上述Flash等方式，以（被攻击）用户的身份执行一些管理动作，或执行一些一般的如发微博、加好友、发私信等操作。
- 利用可被攻击的域受到其他域信任的特点，以受信任来源的身份请求一些平时不允许的操作，如进行不当的投票活动。
- 在访问量极大的一些页面上的XSS可以攻击一些小型网站，实现DDoS攻击的效果。

#### 特点

+ 只作用于客户端
+ 被动攻击
+ XSS漏洞可出现的点很多

#### 分类

+ 反射 (非持久) 型XSS：即恶意数据嵌入到页面后会紧跟请求立刻返回到浏览器
+ 储存 (持久) 型XSS：在这种情况下恶意数据一段时间后也能返回
+ DOM XSS：不和服务器交互，针对采用不安全的方式从document.location 或document.URL 或 document.referrer获取数据的HTML页面

### SQL 注入攻击

#### 概述

SQL攻击（英语：SQL injection），简称注入攻击，是发生于应用程序之数据库层的安全漏洞。简而言之，是在输入的字符串之中注入SQL指令，在设计不良的程序当中忽略了检查，那么这些注入进去的指令就会被数据库服务器误认为是正常的SQL指令而运行，因此遭到破坏或是入侵

#### 攻击手段与原理

1. SQL命令可查询、插入、更新、删除等，命令的串接。而以分号字符为不同命令的区别。（原本的作用是用于SubQuery或作为查询、插入、更新、删除……等的条件式）
2. SQL命令对于传入的字符串参数是用单引号字符所包起来。（但连续2个单引号字符，在SQL数据库中，则视为字符串中的一个单引号字符）
3. SQL命令中，可以注入注解（连续2个减号字符 `--` 后的文字为注解，或“`/*`”与“`*/`”所包起来的文字为注解）
4. 因此，如果在组合SQL的命令字符串时，未针对单引号字符作取代处理的话，将导致该字符变量在填入命令字符串时，被恶意窜改原本的SQL语法的作用。

### OS 命令注入攻击

是指通过 Web应用 中执行非法的操作系统命令以达到攻击目的，只要**在能调用 Shell 函数的地方**就存在被攻击的风险

### HTTP 首部注入攻击

#### 概述

是指攻击者通过在**响应首部字段内加入换行**，添加任意首部或者主体的一种攻击

#### 攻击手段与目的

1. 设置任何 Cookie 信息
2. 重定向到任意 URL
3. 显示任意主体（HTTP 响应截断攻击）

> HTTP 响应截断攻击
>
> 把两个`%0D%0A` 并排插入可以做出 HTTP首部 和 主体 分割用的空行
>
> 这样就可以显示伪造的主体，达到攻击目的

### 邮件首部注入攻击

和 HTTP 首部注入攻击 及其相似，只不过是更改邮件报文

### 目录遍历攻击

**攻击者通过访问根目录，发送一系列”../”字符来遍历高层目录，并且可以执行系统命令，甚至使系统崩溃**，一次目录遍历攻击（directory traversal attack）通常利用了“服务器安全认证缺失”或者“用户提供输入的文件处理操作”，使得服务器端文件操作接口执行了带有“遍历父文件目录”意图的恶意输入字符。 这种攻击的目的通常是利用服务器相关（存在安全漏洞的）应用服务，来恶意的获取服务器上本不可访问的文件访问权限。该攻击利用了程序自身安全的缺失（对于程序本身的意图而言是合法的），因此存在目录遍历缺陷的程序往往本身没有什么逻辑缺陷。 目录遍历攻击也被称为“../攻击”、“目录爬寻”以及“回溯攻击”。甚至有些形式的目录遍历攻击是公认的标准化缺陷。

### 远程文件漏洞

当部分脚本内容需要通过其他文件引入时，攻击者利用外部服务器的 URL 充当依赖文件，让脚本读取后，就可以运行任意脚本的一种攻击

## 因设置或设计缺陷导致

### 强制浏览

是指从 Web服务器 的公开目录文件中，浏览那些非自愿公开的文件

### 不正确的错误消息处理

是指 Web应用 给出了对攻击者有利的错误信息

### 开放重定向

是指对任意 URL 的重定向，用户会被诱导至攻击者想要的另一个站点

> 可信度高的网站如果开放重定向，有可能被攻击者作为钓鱼攻击的跳板

## 因会话管理疏忽引发

### 会话劫持

是指攻击通过某种手段拿到了用户的会话ID，并伪装成用户进行非法操作

### 会话固定攻击

#### 步骤

1. 攻击者访问 Web网站，拿到一个会话ID，此ID还处于未认证状态
2. 攻击者强制某用户使用此会话ID，并等待用户完成认证
3. 感觉差不多了以后，攻击者再使用此会话ID进行伪装

### 跨站点请求伪造

#### 概述

跨站请求伪造（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。跟跨网站脚本（XSS）相比，XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户网页浏览器的信任。

#### 攻击手段

跨站请求攻击，简单地说，是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并执行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去执行。这利用了web中用户身份验证的一个漏洞：简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的。

## 其他

### 密码破解

#### 方法

+ 试错
  + 穷举：尝试所有的候选密码
  + 字典攻击：通过事先收集好的候选密码进行尝试
+ 破解 (已获得加密或者散列处理后的密码数据的情况)
  + 通过穷举，字典攻击进行类推：采用试错相同的方法，现对候选密码进行加密，再进行比对
  + 彩虹表：使用一张由明文密码和其散列值对应的数据表来进行查找
  + 拿到密钥：拿到共享密钥
  + 加密算法漏洞

### 点击劫持

利用透明的链接覆盖在页面之上，诱使用户在不知情的情况下点击来达到攻击的目的

### DoS攻击

拒绝服务攻击（英语：denial-of-service attack，缩写：DoS attack、DoS）亦称洪水攻击，是一种网络攻击手法，其目的在于**使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问**。当黑客使用网络上两个或以上被攻陷的电脑作为“僵尸”向特定的目标发动“拒绝服务”式攻击时，其称为分布式拒绝服务攻击（distributed denial-of-service attack，缩写：DDoS attack、DDoS）。据2014年统计，被确认为大规模DDoS的攻击已达平均每小时28次。攻击发起者一般针对重要服务进行攻击，如银行，信用卡支付网关，甚至根域名服务器。

### 后门

指开发时设置的隐藏入口，可以使用原本受限制的功能



